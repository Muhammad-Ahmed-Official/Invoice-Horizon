generator client {
  provider        = "prisma-client"
  output          = "../src/generated/prisma"
  moduleFormat    = "cjs"
}

datasource db {
  provider = "postgresql"
}

model User {
  id          String     @id @default(uuid())
  name        String  
  email       String     @unique
  password    String  
  role        Role       @default(USER)
  isVerified  Boolean    @default(false)
  otp         Int?
  otpExpiry   DateTime?
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  companyInfo  CompanyInfo[]
}

enum Role {
  USER
  ADMIN
}

model CompanyInfo {
  id           String   @id @default(uuid())
  companyName  String
  email        String   @unique()
  phone        String   @unique()
  address      String  
  taxRate      Int
  paymentTerms String

  
  userId     String     @unique()
  user       User       @relation(fields: [userId], references: [id])
}

model Client {
  id          String   @id @default(uuid())
  name        String   
  email       String       @unique()
  phone       String 
  role        ClientType   @default(CUSTOMER)

  invoices  Invoice[]
}

enum ClientType {
  CUSTOMER
  VENDOR
}

model Invoice {
  id         String         @id  @default(uuid())
  issueDate  DateTime
  dueDate    DateTime
  createdAt  DateTime       @default(now())
  total      Float
  status    statusType

  items      InvoiceItem[]
  
  clientId   String
  client     Client        @relation(fields: [clientId], references: [id])

  @@index([clientId])
}

enum statusType {
  PAID
  PENDING
  OVERDUE
}


model InvoiceItem {
  id           String   @id @default(uuid())
  description  String 
  quantity     Int 
  rate         Float

  invoice      Invoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  invoiceId    String
}